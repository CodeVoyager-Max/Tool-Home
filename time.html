<!DOCTYPE html>
 <html lang="zh-CN">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>作息管理工具</title>
     <style>
         /* 弹窗样式 */
         .modal {
             display: none;
             position: fixed;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background-color: rgba(0, 0, 0, 0.5);
             justify-content: center;
             align-items: center;
         }
         .modal-content {
             background-color: white;
             padding: 20px;
             border-radius: 8px;
             width: 300px;
         }
         .close {
             float: right;
             font-size: 20px;
             cursor: pointer;
         }
         /* 表单样式 */
         .form-group {
             margin: 15px 0;
         }
         label {
             display: block;
             margin: 5px 0;
         }
         input {
             width: 100%;
             padding: 8px;
             box-sizing: border-box;
             border: 1px solid #ccc;
             border-radius: 4px;
         }
         button {
             width: 100%;
             padding: 10px;
             background-color: #007bff;
             color: white;
             border: none;
             border-radius: 4px;
             cursor: pointer;
             font-size: 16px;
         }
         button:hover {
             background-color: #0056b3;
         }
         /* 作息项列表样式 */
         #scheduleList {
             margin: 20px 0;
             padding: 0;
             list-style: none;
         }
         .schedule-item {
             padding: 10px;
             border: 1px solid #eee;
             border-radius: 4px;
             margin: 10px 0;
             display: flex;
             justify-content: space-between;
             align-items: center;
             gap: 10px;
         }
         .schedule-item .content {
             flex: 1;
         }
         .btn-group {
             display: flex;
             gap: 5px;
         }
         .edit-btn {
             width: 60px;
             padding: 5px;
             background-color: #ffc107;
             font-size: 14px;
         }
         .edit-btn:hover {
             background-color: #ffca2c;
         }
         .delete-btn {
             width: 60px;
             padding: 5px;
             background-color: #dc3545;
             font-size: 14px;
         }
         .delete-btn:hover {
             background-color: #c82333;
         }
         /* 排序提示样式 */
         .sort-tip {
             color: #6c757d;
             font-size: 14px;
         }
     </style>
 </head>
 <body>
     <h1>作息管理工具</h1>
     <p class="sort-tip">✅ 作息项已按 <b>开始时间</b> 自动排序</p>
     <button id="addBtn">添加作息项</button>
     <ul id="scheduleList"></ul>
     <!-- 添加/编辑作息项弹窗 -->
     <div id="modal" class="modal">
         <div class="modal-content">
             <span class="close">&times;</span>
             <h2 id="modalTitle">添加作息项</h2>
             <form id="scheduleForm">
                 <input type="hidden" id="editIndex">
                 <div class="form-group">
                     <label for="title">标题</label>
                     <input type="text" id="title" placeholder="例如：睡眠、工作" required>
                 </div>
                 <div class="form-group">
                     <label>时间</label>
                     <div style="display: flex; gap: 10px;">
                         <input type="time" id="startTime" required>
                         <input type="time" id="endTime" required>
                     </div>
                 </div>
                 <button type="submit">保存</button>
             </form>
         </div>
     </div>
     <script>
         // 获取DOM元素
         const modal = document.getElementById('modal');
         const addBtn = document.getElementById('addBtn');
         const closeBtn = document.querySelector('.close');
         const scheduleForm = document.getElementById('scheduleForm');
         const scheduleList = document.getElementById('scheduleList');
         const modalTitle = document.getElementById('modalTitle');
         const editIndex = document.getElementById('editIndex');
         const titleInput = document.getElementById('title');
         const startTimeInput = document.getElementById('startTime');
         const endTimeInput = document.getElementById('endTime');
         // 本地存储操作
         function getScheduleData() {
             const data = localStorage.getItem('scheduleItems');
             return data ? JSON.parse(data) : [];
         }
         function saveScheduleData(data) {
             localStorage.setItem('scheduleItems', JSON.stringify(data));
         }
         // 按开始时间排序
         function sortScheduleByTime(scheduleItems) {
             return scheduleItems.sort((a, b) => {
                 const timeA = a.startTime.split(':').reduce((h, m) => h*60 + parseInt(m));
                 const timeB = b.startTime.split(':').reduce((h, m) => h*60 + parseInt(m));
                 return timeA - timeB;
             });
         }
         // 渲染列表
         function renderScheduleList() {
             let scheduleItems = getScheduleData();
             scheduleItems = sortScheduleByTime(scheduleItems);
             scheduleList.innerHTML = '';
             scheduleItems.forEach((item, index) => {
                 const listItem = document.createElement('li');
                 listItem.className = 'schedule-item';
                 listItem.innerHTML = `
                     <div class="content">
                         <h3>${item.title}</h3>
                         <p>时间：${item.startTime} - ${item.endTime}</p>
                     </div>
                     <div class="btn-group">
                         <button class="edit-btn" data-index="${index}">编辑</button>
                         <button class="delete-btn" data-index="${index}">删除</button>
                     </div>
                 `;
                 scheduleList.appendChild(listItem);
             });
             bindEditEvents();
             bindDeleteEvents();
         }
         // 编辑事件绑定
         function bindEditEvents() {
             document.querySelectorAll('.edit-btn').forEach(btn => {
                 btn.addEventListener('click', () => {
                     const index = parseInt(btn.getAttribute('data-index'));
                     let scheduleItems = getScheduleData();
                     scheduleItems = sortScheduleByTime(scheduleItems);
                     const editItem = scheduleItems[index];
                     
                     modalTitle.textContent = '编辑作息项';
                     editIndex.value = index;
                     titleInput.value = editItem.title;
                     startTimeInput.value = editItem.startTime;
                     endTimeInput.value = editItem.endTime;
                     modal.style.display = 'flex';
                 });
             });
         }
         // 删除事件绑定
         function bindDeleteEvents() {
             document.querySelectorAll('.delete-btn').forEach(btn => {
                 btn.addEventListener('click', () => {
                     const index = parseInt(btn.getAttribute('data-index'));
                     let scheduleItems = getScheduleData();
                     scheduleItems = sortScheduleByTime(scheduleItems);
                     scheduleItems.splice(index, 1);
                     saveScheduleData(scheduleItems);
                     renderScheduleList();
                 });
             });
         }
         // 打开添加弹窗
         addBtn.addEventListener('click', () => {
             modalTitle.textContent = '添加作息项';
             editIndex.value = '-1';
             scheduleForm.reset();
             modal.style.display = 'flex';
         });
         // 关闭弹窗
         closeBtn.addEventListener('click', () => modal.style.display = 'none');
         window.addEventListener('click', (e) => e.target === modal && (modal.style.display = 'none'));
         // 提交表单（含重复项校验）
         scheduleForm.addEventListener('submit', (e) => {
             e.preventDefault();
             const index = parseInt(editIndex.value);
             const newItem = {
                 title: titleInput.value,
                 startTime: startTimeInput.value,
                 endTime: endTimeInput.value
             };
             let scheduleItems = getScheduleData();
             // 新增时校验重复项
             if (index === -1) {
                 const isDuplicate = scheduleItems.some(item => 
                     item.title === newItem.title && item.startTime === newItem.startTime && item.endTime === newItem.endTime
                 );
                 if (isDuplicate) {
                     alert('已存在相同标题和时间的作息项，请勿重复添加！');
                     return;
                 }
                 scheduleItems.push(newItem);
             } else {
                 scheduleItems = sortScheduleByTime(scheduleItems);
                 scheduleItems[index] = newItem;
             }
             saveScheduleData(scheduleItems);
             renderScheduleList();
             modal.style.display = 'none';
         });
         // 页面加载渲染
         window.addEventListener('DOMContentLoaded', renderScheduleList);
     </script>
 </body>
 </html>
